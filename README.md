# Google Sheets 견적서 생성기 (GSheet Invoice Quote)

Google Sheets 데이터를 기반으로 깔끔한 견적서 PDF를 생성하고 Drive에 저장하는 Apps Script 프로젝트입니다.

## 📌 주요 기능

1.  **원클릭 PDF 저장/미리보기**: 스프레드시트 메뉴에서 PDF 저장 또는 미리보기를 실행합니다.
2.  **스마트 데이터 처리**:
    *   선택한 셀의 '견적번호'를 자동으로 인식하여 관련 행을 모두 수집합니다.
    *   **품명 기준 자동 정렬** (가나다순) 기능을 지원합니다.
3.  **전문적인 양식**:
    *   HTML 템플릿 기반의 깔끔한 A4 디자인.
    *   **품명 중복 시 셀 병합(RowSpan)** 처리로 가독성을 높였습니다.
4.  **자동 저장 및 관리**:
    *   Google Drive의 `/견적서` 폴더에 `[견적번호].pdf`로 자동 저장됩니다.
    *   동일 파일명이 있을 경우 자동으로 덮어씌웁니다(기존 파일 휴지통 이동).
5.  **편의성**:
    *   PDF 저장 완료 후 바로가기 링크를 모달로 제공합니다.
    *   미리보기는 PDF 저장 없이 템플릿만 모달로 표시합니다.

## 🚀 시작하기

### 1. 스프레드시트 구조 준비

다음과 같은 헤더 열이 반드시 1행에 존재해야 합니다 (순서 무관):
*   `견적번호`, `견적일`, `업체명`, `수신자`, `품명`, `규격`, `수량`, `단가`, `비고`

### 2. 설정 시트 준비

'설정'이라는 이름의 시트를 만들고 공급자 정보를 입력하세요:
*   A열: 키 / B열: 값
*   필수 키: `공급자_상호`, `공급자_대표자`, `공급자_등록번호`, `공급자_사업장주소`, `공급자_업태`, `공급자_종목`, `공급자_연락처`, `공급자_이메일`, `공급자_팩스`

### 3. 사용 방법

1.  Google Sheet를 엽니다.
2.  출력하고자 하는 견적의 아무 셀이나 선택합니다.
3.  상단 메뉴에서 `견적서` > `PDF 저장` 또는 `미리보기`를 클릭합니다.
4.  `PDF 저장`을 선택하면 "PDF 링크" 모달이 뜨고, `미리보기`는 템플릿 모달만 표시됩니다.

## 🛠️ 개발자 가이드 (로컬 개발)

이 프로젝트는 로컬에서 HTML 템플릿을 개발하고 Apps Script로 동기화하는 워크플로를 지원합니다.

### 파일 구조
*   `Code.js`: Apps Script 메인 로직
*   `template.html`: Apps Script에 배포되는 템플릿 (직접 수정 지양)
*   `template-preview.html`: 로컬 개발용 미리보기 템플릿
*   `preview-data.js`: 로컬 개발용 더미 데이터
*   `scripts/sync-template-from-preview.js`: 동기화 스크립트

### 개발 워크플로
1.  **템플릿 수정**: `template-preview.html` 파일을 수정하며 디자인을 작업합니다. (Live Server 등으로 실시간 확인)
2.  **템플릿 동기화**: 작업이 끝나면 아래 명령어로 `template.html`에 반영합니다.
    ```bash
    node scripts/sync-template-from-preview.js
    ```
3.  **배포**: `clasp push`를 통해 Apps Script로 코드를 업로드합니다.

> **주의**: `template.html`의 `<!-- SYNC:BODY:START -->` 등 싱크 마커를 지우면 동기화 스크립트가 작동하지 않습니다.


