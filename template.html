<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
<style>
  /* ===== A4 ì„¤ì • í•µì‹¬ ===== */
  @page {
    size: A4;            /* âœ… A4 ê°•ì œ */
    margin: 14mm;        /* âœ… ì›í•˜ëŠ” ì—¬ë°±(ì–‘ì‹ì— ë§ì¶° ì¡°ì ˆ) */
  }

  /* ëª¨ë“  ìš”ì†Œê°€ í­ ê³„ì‚°ì„ ì•ˆì •ì ìœ¼ë¡œ í•˜ë„ë¡ */
  *, *::before, *::after {
    box-sizing: border-box;
  }

  html, body {
    margin: 0;
    padding: 0;
  }

  body {
    font-family: Arial, "Apple SD Gothic Neo", "Malgun Gothic", sans-serif;
    font-size: 12px;
    background: #eee; /* í™”ë©´ì—ì„œ ì¢…ì´ êµ¬ë¶„ìš© */
  }

  /* ===== í™”ë©´ ë¯¸ë¦¬ë³´ê¸°ìš© â€œA4 ì¢…ì´â€ =====
     - @page marginì´ 14mmë©´ ì‹¤ì œ ë‚´ìš©ì˜ì—­ì€
       ê°€ë¡œ: 210 - 28 = 182mm
       ì„¸ë¡œ: 297 - 28 = 269mm
     - ì•„ë˜ .paperëŠ” â€œì¢…ì´ ì „ì²´â€ì˜ ì™¸ê³½ ì»¨í…Œì´ë„ˆì´ê³ 
       paddingìœ¼ë¡œ ì¸ì‡„ ì—¬ë°±ì„ ë™ì¼í•˜ê²Œ ì¬í˜„í•©ë‹ˆë‹¤.
  */
  .paper {
    width: 210mm;
    min-height: 297mm;     /* âœ… 1ì¥ ê¸°ì¤€ */
    margin: 12px auto;
    background: #fff;
    padding: 14mm;         /* âœ… @page marginê³¼ ë™ì¼í•˜ê²Œ */
    box-shadow: 0 2px 12px rgba(0,0,0,.15);
    overflow: hidden;      /* âœ… íŠ€ì–´ë‚˜ì˜¤ëŠ” ìš”ì†Œ ì°¨ë‹¨ */
  }

  /* ===== ì¸ì‡„/PDF ì‹œì—ëŠ” ì¢…ì´ ì™¸ê³½ íš¨ê³¼ ì œê±° ===== */
  @media print {
    body {
      background: #fff;
    }
    .paper {
      width: auto;
      min-height: auto;
      margin: 0;
      padding: 0;          /* âœ… ì¸ì‡„ ì—¬ë°±ì€ @page marginì´ ë‹´ë‹¹ */
      box-shadow: none;
      overflow: visible;
    }

    /* í¬ë¡¬ì—ì„œ ë°°ê²½ìƒ‰ì´ í•„ìš”í•˜ë©´(í‘œ í—¤ë” ë“±) ì´ ì˜µì…˜ë„ ê³ ë ¤:
       ì¸ì‡„ ëŒ€í™”ìƒìì—ì„œ â€œë°°ê²½ ê·¸ë˜í”½â€ ì²´í¬ê°€ í•„ìš”í•  ìˆ˜ ìˆìŒ */
  }

  /* ===== ì•„ë˜ëŠ” ê¸°ì¡´ ìŠ¤íƒ€ì¼ ìœ ì§€/ì¶”ê°€ ===== */

  .title { text-align: center; font-size: 40px; font-weight: 900; letter-spacing: 6px; margin: 4mm 0 4mm; }
  .box { border: 1px solid #000; padding: 6px 8px; }
  table { border-collapse: collapse; width: 100%; }
  td { padding: 2px 4px; vertical-align: top; }

  table.items { width: 100%; border-collapse: collapse; margin-top: 6mm; }
  table.items th, table.items td { border: 1px solid #000; padding: 4px 6px; }
  table.items th { background: #f5f5f5; text-align: center; }

  .t-right { text-align: right; }
  .t-center { text-align: center; }

  .sum { width: 240px; margin-left: auto; margin-top: 6mm; }
  .sum td { border: 1px solid #000; padding: 4px 6px; }

  .muted { color: #333; }

.supplier-grid { width:100%; border-collapse: collapse; }
.supplier-grid th, .supplier-grid td { border:1px solid #000; padding:6px; }
.supplier-grid .right { text-align:right; }

.info-row { display: flex; gap: 6px; width: 100%; align-items: stretch; }
.info-card { flex: 1 1 0; }
.recipient-grid { width: 100%; border-collapse: collapse; height: 100%; text-align: center; }
.recipient-grid th, .recipient-grid td { border: 1px solid #000; padding: 6px; }
.recipient-grid tr + tr th, .recipient-grid tr + tr td { border-top-color: transparent; }
.recipient-grid tr:not(:last-child) th, .recipient-grid tr:not(:last-child) td { border-bottom-color: transparent; }
#q-rec-company { font-weight: 700; font-size: 25px; padding: 6px 0; }
.top-row { display: flex; justify-content: flex-end; margin: 2mm 0 2mm; }
.quote-no-box { border: 0px ; padding: 4px 8px; min-width: 40mm; }
.quote-no-box .label { display: inline-block; width: 20px; }



</style>


  <script>
    // Apps Script í…œí”Œë¦¿ì—ì„œ ì£¼ì…ëœ ë°ì´í„°ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.
  </script>


</head>

<body>
  <div class="paper">
    
    <!-- ìƒë‹¨ ì •ë³´ -->
    <div class="top-row">
      <div class="quote-no-box" aria-label="ê²¬ì ë²ˆí˜¸">
        <span class="label">NO.</span>
        <span id="q-no"></span>
      </div>
    </div>
    <div class="title">ê²¬ ì  ì„œ</div>
    
    <!-- ê³µê¸‰ë°›ëŠ”ì / ê³µê¸‰ì ì •ë³´ -->
    <div class="info-row" aria-label="ê³µê¸‰ë°›ëŠ”ì ë° ê³µê¸‰ì ì •ë³´">
      <div class="info-card">
        <table class="recipient-grid" aria-label="ê³µê¸‰ë°›ëŠ”ì ì •ë³´">
          
          <tr>
            <td id="q-rec-company"></td>
          </tr>
          <tr>
            <td id="q-rec-person"></td>
          </tr>
          <tr>
            <td id="q-rec-date"></td>
          </tr>
          <tr>
            <td colspan="2" class="t-center">ì•„ë˜ì™€ ê°™ì´ ê²¬ì í•©ë‹ˆë‹¤</td>
          </tr>
        </table>
      </div>

      <!-- ê³µê¸‰ì ì •ë³´ ë°•ìŠ¤ (ê³ ì •) -->
      <div class="supplier-card info-card">
        <table class="supplier-grid" aria-label="ê³µê¸‰ì ì •ë³´">

  <tr class="header">
    <td>ë“±ë¡ë²ˆí˜¸</td><td colspan="3" id="s-reg"></td>
  </tr>
  <tr>
    <td>ìƒ í˜¸</td><td id="s-company"></td>
    <td>ëŒ€í‘œìëª…</td><td id="s-ceo"></td>
  </tr>
  <tr>
    <td>ì‚¬ì—…ì¥ì£¼ì†Œ</td><td colspan="3" id="s-address"></td>
  </tr>
  <tr>
    <td>ì—… íƒœ</td><td id="s-biz-type"></td>
    <td>ì¢… ëª©</td><td id="s-biz-item"></td>
  </tr>
  <tr>
    <td>ì—° ë½ ì²˜</td><td colspan="3" id="s-contact"></td>
  </tr>
</table>
      </div>
    </div>


    <!-- í’ˆëª© í…Œì´ë¸” -->
    <table class="items">
      <thead>
        <tr>
          <th>í’ˆ ëª…</th>
          <th>ê·œ ê²©</th>
          <th>ìˆ˜ëŸ‰</th>
          <th>ë‹¨ ê°€</th>
          <th>ê¸ˆ ì•¡</th>
          <th>ë¹„ ê³ </th>
        </tr>
      </thead>
      <tbody id="items-body"></tbody>
    </table>

    <!-- í•©ê³„ -->
    <div class="sum">
      <table>
        <tr><td>ê³µê¸‰ê°€ì•¡</td><td class="t-right" id="sum-supply"></td></tr>
        <tr><td>ë¶€ ê°€ ì„¸</td><td class="t-right" id="sum-vat"></td></tr>
        <tr><td><b>í•© ê³„</b></td><td class="t-right" id="sum-total"></td></tr>
      </table>
    </div>

  </div>

  <!-- ğŸ” í’ˆëª© í–‰ í…œí”Œë¦¿ -->
  <template id="item-row-template">
    <tr>
          <td class="name"></td>
          <td class="spec"></td>
          <td class="t-center qty"></td>
          <td class="t-right unit"></td>
          <td class="t-right amount"></td>
          <td class="note"></td>
    </tr>
</template>
          
  <script>
const data = <?!= JSON.stringify(data) ?>;

const won = n => "â‚©" + Number(n).toLocaleString("ko-KR");
const dotDate = s => {
  const d = new Date(s);
  if (Number.isNaN(d.getTime())) return s;
  return `${d.getFullYear()}. ${d.getMonth() + 1}. ${d.getDate()}.`;
};

document.getElementById("q-no").textContent = data.header.NO;
document.getElementById("q-rec-date").textContent = dotDate(data.header.ê²¬ì ì¼);
document.getElementById("q-rec-company").textContent = data.header.ê³µìƒí˜¸;
document.getElementById("q-rec-person").textContent = data.header.ìˆ˜ì‹ ì²˜ + " ê·€í•˜";

document.getElementById("s-reg").textContent = data.supplier.regNo || "";
document.getElementById("s-company").textContent = data.supplier.company || "";
document.getElementById("s-ceo").textContent = data.supplier.ceo || "";
document.getElementById("s-address").textContent = data.supplier.address || "";
document.getElementById("s-biz-type").textContent = data.supplier.bizType || "";
document.getElementById("s-biz-item").textContent = data.supplier.bizItem || "";
document.getElementById("s-contact").textContent = data.supplier.contact || "";

document.getElementById("sum-supply").textContent = won(data.supply);
document.getElementById("sum-vat").textContent = won(data.vat);
document.getElementById("sum-total").textContent = won(data.total);

const tbody = document.getElementById("items-body");
const tpl = document.getElementById("item-row-template");

data.items.forEach(it => {
  const row = tpl.content.cloneNode(true);
  row.querySelector(".name").textContent = it.name;
  row.querySelector(".spec").textContent = it.spec;
  row.querySelector(".qty").textContent = it.qty;
  row.querySelector(".unit").textContent = won(it.unit);
  row.querySelector(".amount").textContent = won(it.amount);
  row.querySelector(".note").textContent = it.note || "";
  tbody.appendChild(row);
});


</script>


</body>


</html>
